# 花札 - 花合わせゲーム

本格的な花札ゲーム「花合わせ」のWebアプリケーション。美しいUI、充実した役判定、CPU対戦機能を備えています。

## 主な機能

### 🎴 ゲームプレイ
- **本格的な花札ルール**
  - 全48枚の花札カード実装
  - 正確な役判定システム
  - 月の合わせによるマッチング
  - プレイヤー vs CPU対戦

- **カードシステム**
  - 光札（20点）: 5枚
  - タネ札（10点）: 9枚
  - 短冊札（5点）: 10枚
  - カス札（1点）: 24枚

### 🏆 役の種類（11種類）

#### 高得点役
- **五光**: 光札5枚（15文）
- **四光**: 光札4枚・雨除く（10文）
- **三光**: 光札3枚・雨除く（6文）

#### 特殊役
- **猪鹿蝶**: 猪・鹿・蝶のタネ札（6文）
- **花見酒**: 桜の光札＋菊の盃（5文）
- **月見酒**: 芒の光札＋菊の盃（5文）
- **赤短**: 赤い短冊3枚（6文）
- **青短**: 青い短冊3枚（6文）

#### 基本役
- **タネ**: タネ札5枚以上（1文〜）
- **タン**: 短冊札5枚以上（1文〜）
- **カス**: カス札10枚以上（1文〜）

### 🎨 UI/UX
- **美しいビジュアル**
  - 絵文字によるカード表現
  - グラデーションデザイン
  - スムーズなアニメーション
  - レスポンシブレイアウト

- **プレイヤー支援**
  - ヒント機能
  - 合う札のハイライト
  - ルール表示
  - 役一覧の常時表示

### 📊 ゲーム機能
- ターン表示
- 残り札カウント
- リアルタイムスコア計算
- 統計情報（勝率、総ゲーム数）
- サウンド効果

## ゲームの流れ

### 初期配置
1. プレイヤーに8枚配布
2. CPUに8枚配布
3. 場に8枚配置
4. 残りは山札

### プレイヤーのターン
1. 手札から1枚選択
2. 場の同じ月の札と合わせる
   - 合う札がある → クリックして取得
   - 合う札がない → 「山札から引く」ボタン
3. 山札から1枚引く（自動マッチング）
4. CPUのターンへ

### ゲーム終了
- 手札と山札がすべてなくなったら終了
- 役を計算して得点を比較
- 勝者を判定

## 技術的特徴

### データ構造

```javascript
// カードオブジェクト
{
    id: number,           // 1-48
    month: number,        // 1-12（月）
    name: string,         // 花の名前
    type: string,         // hikari/tane/tan/kasu
    icon: string,         // 絵文字
    points: number,       // 基本点数
    description: string   // 説明
}
```

### 役判定アルゴリズム

```javascript
const YAKU_DEFINITIONS = {
    gokou: {
        name: '五光',
        points: 15,
        check: (cards) => {
            // 光札5枚の判定ロジック
        }
    },
    // ... 他の役
}

function calculateYaku(cards) {
    // すべての役をチェック
    // 合計得点を計算
}
```

### ゲームロジック

```javascript
class HanafudaGame {
    constructor()           // 初期化
    newGame()              // 新規ゲーム開始
    selectHandCard(card)   // 手札選択
    matchCards(fieldCard)  // 札の合わせ
    drawFromDeck()         // 山札から引く
    cpuTurn()              // CPUのターン
    checkGameOver()        // ゲーム終了判定
    calculateYaku(cards)   // 役の計算
}
```

## カードデータベース

全48枚のカードを完全実装：

### 1月（松）
- 松に鶴（光）
- 松に赤短
- カス×2

### 2月（梅）
- 梅に鶯（タネ）
- 梅に赤短
- カス×2

### 3月（桜）
- 桜に幕（光）
- 桜に赤短
- カス×2

*... 12月（桐）まで*

## CPU AIアルゴリズム

```javascript
cpuTurn() {
    // 1. 合う札を優先的に探す
    for (card of cpuHand) {
        if (fieldHasMatch(card)) {
            playCard(card);
            return;
        }
    }

    // 2. 合う札がない場合はランダム
    playRandomCard();
}
```

## 使用方法

### 基本操作
1. 手札から札をクリックして選択
2. 場の同じ月の札をクリック（緑色にハイライト）
3. 合う札がない場合は「山札から引く」
4. CPUのターンを待つ
5. 交互にプレイ

### ボタン
- **新しいゲーム**: ゲームをリセット
- **ヒント**: 合う札を点滅表示
- **遊び方**: ルール説明を表示

## カスタマイズ

### カードデザイン変更
`cards.js`の`HANAFUDA_CARDS`配列を編集：

```javascript
{
    id: 1,
    month: 1,
    name: '松',
    type: 'hikari',
    icon: '🏮',  // ← アイコン変更
    points: 20,
    description: '松に鶴'
}
```

### 役の追加
`cards.js`の`YAKU_DEFINITIONS`に追加：

```javascript
newYaku: {
    name: '新しい役',
    points: 10,
    check: (cards) => {
        // 判定ロジック
        return points;
    }
}
```

### テーマカラー
`style.css`の`:root`セクション：

```css
:root {
    --primary: #ec4899;
    --secondary: #8b5cf6;
    /* ... */
}
```

## パフォーマンス

- 軽量実装（外部ライブラリ不要）
- 効率的な役判定アルゴリズム
- スムーズなアニメーション
- LocalStorageによる統計管理

## ブラウザ対応

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 今後の拡張予定

- [ ] オンライン対戦機能
- [ ] 難易度調整（CPUの強さ）
- [ ] リプレイ機能
- [ ] 詳細な戦績統計
- [ ] カードアニメーションの強化
- [ ] 実際の花札画像対応
- [ ] 音楽・効果音の追加
- [ ] チュートリアルモード
- [ ] 他のルール（こいこい等）

## 技術スタック

- **HTML5**: セマンティックマークアップ
- **CSS3**: Grid, Flexbox, Animations, Variables
- **JavaScript ES6+**: Classes, Modules, LocalStorage
- **Web Audio API**: サウンド効果

## ゲームルール詳細

### 札の取り方
1. 手札から1枚出す
2. 場の同じ月の札と合わせる
3. 合う札がない場合は場に捨てる
4. 山札から1枚めくる
5. 場の同じ月の札と合わせる
6. 合う札がない場合は場に置く

### 得点計算
- 役の点数を合計
- 高い方が勝利
- 同点の場合は引き分け

### 勝利条件
- すべての札がなくなった時点で得点を比較
- 得点の高い方が勝利

## ライセンス

MIT License

---

**開発者向けノート**: このゲームは伝統的な花札「花合わせ」のルールを実装しています。「こいこい」等の他のルールを実装する場合は、役判定システムとゲームフローを拡張する必要があります。
